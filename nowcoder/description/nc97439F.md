# 普通DISCO-2

## 题目描述

_普通的 disco我们普通的摇  
我普通的心在扑通扑通的跳  
有普通的热情在普通的尖叫  
_

_在普通的动次打次之中冲上云霄_

_——ilem《普通DISCO》_

**  
**

**请注意，本题和E题****普通DISCO-1 的区别在于，本题要求使得深度最小化。**

  


给你一棵 $n$ 个节点的树，树根为 $1$ 号节点。  
你可以最多执行**一次** 以下操作（它们是一个整体）：  


  * 选择两个不同的节点 $u,v$ 满足 $u,v$ 均不是树根且 $u,v$ 互相不呈祖先关系。 
  * 记 $u$ 的父亲为 $p$，$v$ 的父亲为 $q$。 
  * 断掉 $u$ 与 $p$，$v$ 与 $q$ 之间的边。 
  * 连接 $u$ 与 $q$，$v$ 与 $p$。 

你需要使得最终这棵树的深度**最小化** 。请输出这个深度。 

## 输入描述:
    
    
    第一行一个正整数 $n$，表示节点个数。  
      
    
    
    接下来 $n-1$ 行，每行 $2$ 个数 $u,v$，表示 $u$ 与 $v$ 之间有一条边。
    
      
    
    
    $(3 \le n \le 5\times 10^5)$  
    

## 输出描述:
    
    
    一行一个数，最小可能达到的深度。

示例1 

## 输入
    
    
    6
    1 2
    2 3
    2 6
    3 4
    4 5

## 输出
    
    
    4

## 备注:
    
    
    ![](https://uploadfiles.nowcoder.com/images/20241202/0_1733069561722/F10C57B2C52364F3BF4E2852B5FA2695)![](https://uploadfiles.nowcoder.com/images/20241202/0_1733069568145/CC9D1CD6C0B285BD2FE1C710D153B4FD)  
    


## 时空限制

时间限制：C/C++/Rust/Pascal 3秒，其他语言6秒
空间限制：C/C++/Rust/Pascal 256 M，其他语言512 M
64bit IO Format: %lld