# 小红统计区间（hard）

## 题目描述

**本题为hard版本，和easy版本的唯一区别是** $a_i$**有可能为负数！**

  


小红拿到了一个数组，她想知道，有多少非空区间满足区间所有元素之和不小于$k$？ 

## 输入描述:
    
    
    第一行输入两个正整数$n,k$，用空格隔开。  
    第二行输入$n$个整数$a_i$，代表数组的元素。  
    $1\leq n \leq 10^5$  
    $-10^9 \leq a_i \leq 10^9$  
    $1\leq k \leq 10^{14}$

## 输出描述:
    
    
    输出一个整数表示满足条件区间的数量。

示例1 

## 输入
    
    
    5 5
    1 4 2 1 3

## 输出
    
    
    8

示例2 

## 输入
    
    
    4 5
    2 -100 5 6

## 输出
    
    
    3


## 时空限制

时间限制：C/C++/Rust/Pascal 1秒，其他语言2秒
空间限制：C/C++/Rust/Pascal 256 M，其他语言512 M
64bit IO Format: %lld