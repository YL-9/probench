# 冰冰的列车

## 题目描述

【说明】

**  
**

**F 题经指出，存在测试数据 std 错误的情况。且目前暂时没有人能保证此题存在完全正确的、保证时空复杂度的解法。**

**  
**

**所以目前定义此题为“假题”。即：**不保证** 存在**可以通过此题的完全正确的、保证时空复杂度的解法。****

****  
****

****数据已更新成修改后的 std 生成。但没有验题人验证，仅供参考。  
****

  


  


【题目描述】  


为了简化问题，假设列车匀速运行，且列车到达站点后不停。 

  
当前铁路网中共有 $n$ 个可停靠的站点，$m$ 趟列车，对于第 $i$ 躺列车，其描述如下：$x,V,k$，$x$ 表示发车时间，$V$ 表示运行速度，$k$ 表示经停站点数。以及 $k$ 个整数 $a_i$ 按经停顺序描述站点，$a_1$ 表示始发站，$a_k$ 表示终点站，保证存在 $a_i$ 和 $a_{i+1}$ 之间的边，保证 $a_i\ne a_j(i\ne j,1\le i,j\le k)$。  
  
对于铁路网，有 $M$ 条线路：$(u,v,w)$ 表示站点 $u,v$ 之间存在一条长度为 $w$ 的线路，线路有方向性，只能从 $u$ 到 $v$。 保证 $u,v$ 之间最多存在一条线路。  
  
请按时间顺序判断第 $i$ 趟发车的列车是否会存在“追尾”，若某趟列车存在“追尾”，则该趟列车在“追尾”的瞬间消失，在后续的判断中即可忽略该趟列车。  
  


追尾是指，在某时刻，对于两辆正行驶在同一条线路 $(u,v)$ 上的列车 $a,b$，$a,b$ 相遇时，若 $V_a>V_b$ 视作 $a$ 存在追尾，若 $V_b>V_a$ 视作 $b$ 存在追尾。  
  
特别地，若存在多辆列车**同时从** $u$**出发** 行驶在线路 $(u,v)$ 上，仅保留编号最大的列车，其它列车均视作存在追尾，在后续的判断中即可忽略这些列车。 

  


若列车还未发车，则它会停在其对应始发站的特定位置，在其它列车运行过程中，不用考虑这些还未发车的列车。 

  


具体请参照样例理解。  


  
输出时，按输入顺序输出列车是否存在追尾。

## 输入描述:
    
    
    第一行两个整数 $n,m(1\leq n,m\leq 10^6)$。  
      
    接下来 $2\times m$ 行，每组两行，第一行三个整数 $x,V,k(1\leq x\le 10^6,1\le V\leq 10^3,1\leq \sum (k-1)\leq 10^6)$，第二行 $k$ 个整数表示 $a_i(1\leq a_i\leq n)$。  
      
    第 $2\times m+2$ 行一个整数 $M(1\leq M\leq \min\lbrace \frac{n(n-1)}{2},10^6\rbrace)$ 表示路径数。  
      
    接下来 $M$ 行，每行三个整数表示 $u,v,w(1\leq u,v\leq n,1\leq w\leq 10^3)$。

## 输出描述:
    
    
    输出共 $m$ 行，第 $i$ 行输出 `YES` 表示第 $i$ 趟列车存在追尾，反之输出 `NO` 。

示例1 

## 输入
    
    
    4 2
    2 1 2
    2 3
    1 3 3
    1 2 3
    3
    1 2 4
    2 3 3
    3 4 1

## 输出
    
    
    NO
    YES

示例2 

## 输入
    
    
    3 2
    1 1 2
    1 2
    2 1 2
    3 2
    2
    1 2 4
    3 2 3

## 输出
    
    
    NO
    NO

## 说明
    
    
    列车 $1$ 和列车 $2$ 在 $t=5$ 时，同时到达 $2$ 号点，但是它们 $t=5$ 的上一时刻不在同一条线路上，列车 $1$ 在 $(1,2,4)$ 上，列车 $2$ 在 $(3,2,3)$ 上。所以列车 $1$ 和列车 $2$ 不视作存在追尾。  
    

示例3 

## 输入
    
    
    4 2
    1 1 3
    1 2 4
    2 1 3
    3 2 4
    3
    1 2 4
    3 2 3
    2 4 2

## 输出
    
    
    YES
    NO

## 说明
    
    
    列车 $1$ 和列车 $2$ 在 $t=5$ 时，同时到达 $2$ 号点，此时列车 $1$ 和列车 $2$ 同时从 $2$ 号点出发前往 $4$ 号点且在同一条线路上，且出发时刻相同。此时编号小的列车消失。所以列车 $1$ 追尾列车 $2$ 。  
    

示例4 

## 输入
    
    
    4 2
    1 1 3
    1 2 4
    4 2 3
    3 2 4
    3
    1 2 2
    3 2 3
    2 4 5

## 输出
    
    
    NO
    YES

## 说明
    
    
    列车 $1$ 在 $t=3$ 时到达 $2$ 号点，列车 $2$ 在 $t=\dfrac{11}{2}$ 时到达 $2$ 号点，此时列车 $1$ 运行在线路 $(2,4,5)$ 上，在 $t=8$ 时，列车 $2$ 在 $4$ 号点恰好追上列车 $1$，所以列车 $2$ 视作追尾。  
    

示例5 

## 输入
    
    
    6 2
    1 1 3
    1 2 4
    4 2 3
    3 2 5
    4
    1 2 5
    3 2 6
    2 4 5
    2 5 6

## 输出
    
    
    NO
    NO

## 说明
    
    
    列车 $1$ 和列车 $2$ 在 $t=6$ 时同时到达 $2$ 号点，但是它们并没有同时从 $2$ 号点出发经过同一条线路，所以列车 $1$ 和列车 $2$ 不视作追尾。  
    

示例6 

## 输入
    
    
    6 3
    1 1 3
    1 2 4
    4 2 4
    3 2 4 5
    8 4 3
    6 4 5
    5
    1 2 4
    3 2 3
    2 4 2
    4 5 20
    6 4 4

## 输出
    
    
    NO
    YES
    NO

## 说明
    
    
    列车 $1$ 和列车 $2$ 在 $t=6$ 时在 $(2,4,2)$ 产生追尾，视作列车 $2$ 追尾列车 $1$，所以列车 $2$ 在 $t=8$ 瞬间消失，在后续列车运行过程中忽略列车 $2$。若不忽略列车 $2$，列车 $2$ 和列车 $3$ 将在线路 $(4,5,20)$ 之间产生追尾。  
    


## 时空限制

时间限制：C/C++/Rust/Pascal 4秒，其他语言8秒
空间限制：C/C++/Rust/Pascal 512 M，其他语言1024 M
64bit IO Format: %lld