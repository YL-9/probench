# 相依

## 题目描述

**此题为C题的hard版，只有** $a_i$**的数据范围不同。**

给你一个 $n$ 个正整数组成的数组 a ，你每次操作可以选择一对 $( i, j )$，满足 $1 \leq i < j \leq n$，且 $a_{i} = a_{j}$ ，将 { $a_{i} , a_{i+1} , ... , a_{j-1} , a_{j}$ } 这段数删除，操作之后数组变为 { $a_{1},a_{2}, ..., a_{i-1},a_{j+1}, ...,a_{n-1},a_{n}$ }。文文想知道最少要做多少次操作才能将数组变为空。

  


## 输入描述:
    
    
    第一行一个正整数输入 $n$ $( 1 \leq n \leq 5 \times 10^5 )$。
    
    第二行依次输入 $n$ 个正整数 $a_{1},a_{2},...,a_{n-1},a_{n}$，每个数之间以空格分开。$( 0 \leq a_i \leq n )$

## 输出描述:
    
    
    输出一行，代表最少的操作次数，如果无论如何都无法使数组为空就输出 -1。

示例1 

## 输入
    
    
    5
    3 2 3 2 2

## 输出
    
    
    2

## 说明
    
    
    例如，n 为 5，数组为$\{3, 2, 3, 2, 2\}$，第一次操作我们可以选择 $i = 1$，$j = 3$，把这一段删除后数组变为 $\{2, 2\}$，第二次操作我们可以选择 $i = 1$，$j = 2$，把这一段删除后数组变为空，操作了两次。

示例2 

## 输入
    
    
    5
    1 2 3 4 5

## 输出
    
    
    -1


## 时空限制

时间限制：C/C++/Rust/Pascal 1秒，其他语言2秒
空间限制：C/C++/Rust/Pascal 256 M，其他语言512 M
64bit IO Format: %lld