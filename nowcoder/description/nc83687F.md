# 异或炸弹（hard）

## 题目描述

**此题为D题的hard版本，与D题仅有m的取值范围不同**

给定一个$n*n$的矩阵，初始全是 $​0$， 

现在文文手上有 $m$ 个炸弹, 

对于每一个炸弹，都有自己的 **爆炸中心$(x, y)$** 和 **爆炸半径 $r$.**

当矩阵内某个位置与**爆炸中心** 的 **曼哈顿距离** 小于等于 $r$ 时，该位置就会收到爆炸的影响， 爆炸的影响就是给这个位置上的数**异或 $1$.**

文文给你这 $m$ 个炸弹的爆炸位置和爆炸半径，你需要回答文文这个矩阵中 $1$ 的个数 

如果不明白 **异或操作** 和 **曼哈顿距离** ，请看最后的提示

********

********

## 输入描述:
    
    
    第一行给定两个正整数 $n ,m$, 分别表示矩阵大小和炸弹数量 
    
    接下来$m$行，每行$3$个正整数其中第 $i$ 行的前2个正整数 $x_i ,y_i$ 表示第 $i$ 个炸弹的爆炸中心最后一个正整数 $r_i$ 表示第 $i$ 个炸弹的爆炸半径
    
    $1 \leq n \leq 3000, 1\leq m \leq 5 *10^5$
    
    $1 \leq x_i, y_i \leq n$
    
    $0 \leq r_i \leq 6000$
    
    __

## 输出描述:
    
    
    输出被轰炸后的矩阵中 $1$ 的个数

示例1 

## 输入
    
    
    5 1
    3 3 1

## 输出
    
    
    5

## 说明
    
    
    案例解释
    
    0 0 0 0 0
    
    0 0 1 0 0
    
    0 1 1 1 0
    
    0 0 1 0 0
    
    0 0 0 0 0
    
    共有5个1 

## 备注:
    
    
    关于异或的运算
    
    0 ^ 1 = 1
    
    1 ^ 1 = 0
    
    1 ^ 0 = 1
    
    0 ^ 0 = 0
    
      
    
    
    关于曼哈顿距离的运算如果两个点的坐标分别是$(x1,y1),(x2,y2)$ 那么两个点的曼哈顿距离$d = |x1-x2|+|y1-y2|$.
    
      
    
    
      
    
    
      
    


## 时空限制

时间限制：C/C++/Rust/Pascal 2秒，其他语言4秒
空间限制：C/C++/Rust/Pascal 512 M，其他语言1024 M
64bit IO Format: %lld